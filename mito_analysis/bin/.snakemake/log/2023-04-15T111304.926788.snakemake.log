Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	add_trait_data
	1	alignment_filter
	1	all
	1	fasta_split
	1	format_fasta
	1	gather_vcfs
	6	genome_to_read
	1	low_cov_calc
	1	make_nexus
	1	ncbi_download
	1	remove_bad_samples
	1	run_nfcore
	1	snp_only
	18

[Sat Apr 15 11:13:06 2023]
rule ncbi_download:
    output: temp.gb, concat.fa
    jobid: 17

Removing temporary output file temp.gb.
[Sat Apr 15 11:13:09 2023]
Finished job 17.
1 of 18 steps (6%) done

[Sat Apr 15 11:13:09 2023]
rule fasta_split:
    input: concat.fa
    output: input_files/sample_fastas/NC_028626.1.fa, input_files/sample_fastas/NC_007243.1.fa, input_files/sample_fastas/MZ666366.1.fa, input_files/sample_fastas/MZ440348.1.fa, input_files/sample_fastas/KY923424.1.fa, input_files/sample_fastas/LT841393.1.fa
    jobid: 16

[Sat Apr 15 11:13:09 2023]
Finished job 16.
2 of 18 steps (11%) done

[Sat Apr 15 11:13:09 2023]
rule genome_to_read:
    input: input_files/sample_fastas/MZ666366.1.fa
    output: input_files/genome_to_read/MZ666366.1_reads.fastq.gz
    jobid: 12
    wildcards: sample=MZ666366.1


[Sat Apr 15 11:13:09 2023]
rule genome_to_read:
    input: input_files/sample_fastas/NC_007243.1.fa
    output: input_files/genome_to_read/NC_007243.1_reads.fastq.gz
    jobid: 11
    wildcards: sample=NC_007243.1


[Sat Apr 15 11:13:10 2023]
rule genome_to_read:
    input: input_files/sample_fastas/LT841393.1.fa
    output: input_files/genome_to_read/LT841393.1_reads.fastq.gz
    jobid: 15
    wildcards: sample=LT841393.1


[Sat Apr 15 11:13:10 2023]
rule genome_to_read:
    input: input_files/sample_fastas/MZ440348.1.fa
    output: input_files/genome_to_read/MZ440348.1_reads.fastq.gz
    jobid: 13
    wildcards: sample=MZ440348.1

[Sat Apr 15 11:13:10 2023]
Finished job 12.
3 of 18 steps (17%) done

[Sat Apr 15 11:13:10 2023]
rule genome_to_read:
    input: input_files/sample_fastas/NC_028626.1.fa
    output: input_files/genome_to_read/NC_028626.1_reads.fastq.gz
    jobid: 10
    wildcards: sample=NC_028626.1

[Sat Apr 15 11:13:10 2023]
Finished job 13.
4 of 18 steps (22%) done
[Sat Apr 15 11:13:10 2023]
Finished job 11.
5 of 18 steps (28%) done

[Sat Apr 15 11:13:10 2023]
rule genome_to_read:
    input: input_files/sample_fastas/KY923424.1.fa
    output: input_files/genome_to_read/KY923424.1_reads.fastq.gz
    jobid: 14
    wildcards: sample=KY923424.1

[Sat Apr 15 11:13:10 2023]
Finished job 15.
6 of 18 steps (33%) done
[Sat Apr 15 11:13:10 2023]
Finished job 10.
7 of 18 steps (39%) done
[Sat Apr 15 11:13:10 2023]
Finished job 14.
8 of 18 steps (44%) done

[Sat Apr 15 11:13:10 2023]
rule run_nfcore:
    input: input_files/genome_to_read/NC_028626.1_reads.fastq.gz, input_files/genome_to_read/NC_007243.1_reads.fastq.gz, input_files/genome_to_read/MZ666366.1_reads.fastq.gz, input_files/genome_to_read/MZ440348.1_reads.fastq.gz, input_files/genome_to_read/KY923424.1_reads.fastq.gz, input_files/genome_to_read/LT841393.1_reads.fastq.gz
    output: eager/multivcfanalyzer/snpTable.tsv.gz, eager/multivcfanalyzer/snpAlignment.fasta.gz
    jobid: 9

[Sat Apr 15 11:23:43 2023]
Finished job 9.
9 of 18 steps (50%) done

[Sat Apr 15 11:23:43 2023]
rule gather_vcfs:
    input: eager/multivcfanalyzer/snpTable.tsv.gz, eager/multivcfanalyzer/snpAlignment.fasta.gz
    output: multivcf_out/snpTable.tsv, multivcf_out/snpAlignment.fasta
    jobid: 7

[Sat Apr 15 11:23:45 2023]
Finished job 7.
10 of 18 steps (56%) done

[Sat Apr 15 11:23:45 2023]
rule format_fasta:
    input: multivcf_out/snpTable.tsv, multivcf_out/snpAlignment.fasta
    output: alignments/fullAlignment_noReference.fasta
    jobid: 8

[Sat Apr 15 11:23:45 2023]
Finished job 8.
11 of 18 steps (61%) done

[Sat Apr 15 11:23:45 2023]
rule low_cov_calc:
    input: alignments/fullAlignment_noReference.fasta
    output: low_cov_samples.txt, nuc_freq.txt
    jobid: 6

Removing temporary output file alignments/fullAlignment_noReference.fasta.
Removing temporary output file nuc_freq.txt.
[Sat Apr 15 11:23:46 2023]
Finished job 6.
12 of 18 steps (67%) done

[Sat Apr 15 11:23:46 2023]
rule remove_bad_samples:
    input: low_cov_samples.txt, multivcf_out/snpTable.tsv
    output: alignments/snpTable/snpTable_exclude_lowcov_indivs.tsv
    jobid: 5

Removing temporary output file low_cov_samples.txt.
[Sat Apr 15 11:23:48 2023]
Finished job 5.
13 of 18 steps (72%) done

[Sat Apr 15 11:23:48 2023]
rule alignment_filter:
    input: alignments/snpTable/snpTable_exclude_lowcov_indivs.tsv
    output: alignments/partial_deletion_filter
    jobid: 4

[Sat Apr 15 11:23:50 2023]
Finished job 4.
14 of 18 steps (78%) done

[Sat Apr 15 11:23:50 2023]
rule snp_only:
    input: alignments/partial_deletion_filter
    output: alignments/final, tmp.tsv
    jobid: 3

Removing temporary output file tmp.tsv.
[Sat Apr 15 11:23:51 2023]
Finished job 3.
15 of 18 steps (83%) done

[Sat Apr 15 11:23:51 2023]
rule make_nexus:
    input: alignments/final
    output: filtered_snp_alignment.nex
    jobid: 2

[Sat Apr 15 11:23:52 2023]
Finished job 2.
16 of 18 steps (89%) done

[Sat Apr 15 11:23:52 2023]
rule add_trait_data:
    input: filtered_snp_alignment.nex
    output: nexus_final.nex
    jobid: 1

Removing temporary output file filtered_snp_alignment.nex.
[Sat Apr 15 11:23:55 2023]
Finished job 1.
17 of 18 steps (94%) done

[Sat Apr 15 11:23:55 2023]
localrule all:
    input: nexus_final.nex
    jobid: 0

[Sat Apr 15 11:23:55 2023]
Finished job 0.
18 of 18 steps (100%) done
Complete log: /mnt/archgen/users/michel/plasmodium/08-phylogeny/plasmodium_phylogenies/bin/.snakemake/log/2023-04-15T111304.926788.snakemake.log
